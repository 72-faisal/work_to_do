package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import connection.Dbconnection;
import model.Doctordata;

public class Doctordao {

	public static void insertDoctor(Doctordata d) {
		try {
			Connection con = Dbconnection.getconnection();
			String sql="insert into Doctordata(dname,demail,dpassword,dhaddress,dcaddress,dspeciality,dcontact) values(?,?,?,?,?,?,?)";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, d.getDname());
			pst.setString(2, d.getDemail());
			pst.setString(3, d.getDpassword());
			pst.setString(4, d.getDhaddress());
			pst.setString(5, d.getDcaddress());
			pst.setString(6, d.getDspeciality());
			pst.setLong(7, d.getDContact());
			pst.executeUpdate();
			System.out.println("data inserted");
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	public static Doctordata DoctorLogin(Doctordata d) {
		Doctordata d1 = null;
		try {
			Connection con = Dbconnection.getconnection();
			String sql="select * from Doctordata where demail=? and dpassword=?";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, d.getDemail());
			pst.setString(2, d.getDpassword());
			ResultSet rs = pst.executeQuery();
			if(rs.next()) {
				d1 = new Doctordata();
				d1.setDid(rs.getInt("did"));
				d1.setDname(rs.getString("dname"));
				d1.setDemail(rs.getString("demail"));
				d1.setDpassword(rs.getString("dpassword"));
				d1.setDhaddress(rs.getString("dhaddress"));
				d1.setDcaddress(rs.getString("dcaddress"));
				d1.setDspeciality(rs.getString("dspeciality"));
				d1.setDContact(rs.getLong("dcontact"));
				
			}
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		return d1;
	
		
	}public static void updateProfile(Doctordata d) {
		try {
			Connection con = Dbconnection.getconnection();
			String sql="update Doctordata set dname=?,demail=?,dhaddress=?,dcaddress=?,dspeciality=?,dcontact=? where did=?";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, d.getDname());
			pst.setString(2, d.getDemail());
			pst.setString(3, d.getDhaddress());
			pst.setString(4, d.getDcaddress());
			pst.setLong(5,d.getDContact());
			pst.setString(6, d.getDspeciality());
			pst.setInt(7, d.getDid());
			pst.executeUpdate();
			System.out.println("profile updated");
		} catch (Exception e) {
			e.printStackTrace();
		}
		
	}
	public static boolean checkOldPassword(String op,int id) {
		boolean flag = false;
		try {
			Connection con = Dbconnection.getconnection();
			String sql="select * from Doctordata where dpassword=? and did=?";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, op);
			pst.setInt(2, id);
			ResultSet rs = pst.executeQuery();
			if(rs.next()) {
				flag = true;
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return flag;
	}
	public static void updatePassword(String np,int id) {
		try {
			Connection con = Dbconnection.getconnection();
			String sql="update Doctordata set dpassword=? where did=?";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, np);
			pst.setInt(2, id);
			pst.executeUpdate();
			System.out.println("password changed");
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
		
	
}
