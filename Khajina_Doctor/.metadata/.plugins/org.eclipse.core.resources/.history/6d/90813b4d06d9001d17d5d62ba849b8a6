package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import connection.Dbconnection;
import model.Doctordata;

public class Doctordao {

	public static void insertDoctor(Doctordata d) {
		try {
			Connection con = Dbconnection.getconnection();
			String sql="insert into Doctordata(dname,demail,dpassword,dhaddress,dcaddress,dspeciality,dcontact) values(?,?,?,?,?,?,?)";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, d.getDname());
			pst.setString(2, d.getDemail());
			pst.setString(3, d.getDpassword());
			pst.setString(4, d.getDhaddress());
			pst.setString(5, d.getDcaddress());
			pst.setString(6, d.getDspeciality());
			pst.setLong(7, d.getDContact());
			pst.executeUpdate();
			System.out.println("data inserted");
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	public static Doctordata DoctorLogin(Doctordata d) {
		Doctordata d1 = null;
		try {
			Connection con = Dbconnection.getconnection();
			String sql="select * from Doctordata where demail=? and dpassword=?";
			PreparedStatement pst = con.prepareStatement(sql);
			pst.setString(1, d.getDemail());
			pst.setString(2, d.getDpassword());
			ResultSet rs = pst.executeQuery();
			if(rs.next()) {
				d1 = new Doctordata();
				d1.setDid(rs.getInt("id"));
				d1.setDname(rs.getString("name"));
				d1.setDemail(rs.getString("email"));
				d1.setDpassword(rs.getString("password"));
				d1.setDhaddress(rs.getString("dhaddress"));
				d1.setDcaddress(rs.getString("dcaddress"));
				d1.setDspeciality(rs.getString("dspeciality"));
				d1.setDContact(rs.getLong("dcontact"));
				
			}
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		return d1;
	
		
	}
		
	
}
